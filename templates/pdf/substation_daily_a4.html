<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <title>{{ title }}</title>
  <style>
    @page {
      size: A4;
      margin: 7mm;
    }
    body {
      margin: 0;
      font-family: "HYSMyeongJo-Medium", "Malgun Gothic", "NanumGothic", sans-serif;
      color: #111;
      font-size: 11px;
      line-height: 1.2;
    }
    .sheet {
      width: 100%;
    }
    table.box {
      width: 100%;
      border-collapse: collapse;
      table-layout: fixed;
      border: 2px solid #111;
      margin: 0 0 6px 0;
      page-break-inside: avoid;
    }
    table.box th,
    table.box td {
      border: 1px solid #111;
      text-align: center;
      vertical-align: middle;
      padding: 6px 4px;
      word-break: keep-all;
    }
    .title-cell {
      font-size: 20px;
      font-weight: 700;
      text-decoration: underline;
      letter-spacing: -0.8px;
      height: 50px;
    }
    .meta-cell {
      padding: 0;
      height: 42px;
    }
    table.meta-line {
      width: 100%;
      border-collapse: collapse;
      table-layout: fixed;
    }
    table.meta-line td {
      border: 0;
      text-align: left;
      font-size: 11px;
      padding: 0 10px;
    }
    .approval-vert {
      width: 36px;
      font-weight: 700;
      line-height: 1.1;
      letter-spacing: 0;
      font-size: 11px;
    }
    .approve-name {
      font-size: 11px;
      font-weight: 700;
      height: 28px;
    }
    .approve-sign {
      height: 64px;
    }
    .blue {
      background: #d7dfee;
      font-weight: 700;
    }
    .h-big {
      font-size: 13px;
      font-weight: 700;
    }
    .h-mid {
      font-size: 12px;
      font-weight: 700;
    }
    .h-small {
      font-size: 11px;
      font-weight: 700;
    }
    .left {
      text-align: left;
    }
    .pad-tight th,
    .pad-tight td {
      padding: 4px 3px;
    }
    .value-row td,
    .value-row th {
      height: 34px;
      font-weight: 700;
      font-size: 11px;
    }
    .sub-head {
      font-size: 11px;
      font-weight: 700;
    }
    .minor-head {
      font-size: 10px;
      font-weight: 700;
    }
    .small {
      font-size: 10px;
    }
    .row-lbl {
      font-weight: 700;
      font-size: 11px;
    }
  </style>
</head>
<body>
  <div class="sheet">
    <table class="box pad-tight">
      <colgroup>
        <col style="width: 72%">
        <col style="width: 5%">
        <col style="width: 11.5%">
        <col style="width: 11.5%">
      </colgroup>
      <tr>
        <td class="title-cell">{{ title }}</td>
        <th class="approval-vert" rowspan="2">결<br>재</th>
        <th class="approve-name">과장</th>
        <th class="approve-name">소장</th>
      </tr>
      <tr>
        <td class="meta-cell">
          <table class="meta-line">
            <tr>
              <td>{{ entry_date_label }}</td>
              <td>근무자 : {{ worker_name }}</td>
            </tr>
          </table>
        </td>
        <td class="approve-sign"></td>
        <td class="approve-sign"></td>
      </tr>
    </table>

    <table class="box">
      <colgroup>
        <col style="width: 10%">
        <col style="width: 16%">
        <col style="width: 16%">
        <col style="width: 16%">
        <col style="width: 16%">
        <col style="width: 13%">
        <col style="width: 13%">
      </colgroup>
      <tr>
        <th rowspan="2" class="sub-head">구분<br>시간</th>
        <th colspan="4" class="blue h-mid">AISS {{ aiss_kv }}[KV]</th>
        <th colspan="2" class="h-mid">변압기 온도(℃)</th>
      </tr>
      <tr>
        <th class="sub-head">R(A)</th>
        <th class="sub-head">S(A)</th>
        <th class="sub-head">T(A)</th>
        <th class="sub-head">N(A)</th>
        <th class="small">TR-1<br>(450KVA)</th>
        <th class="small">TR-2<br>(400KVA)</th>
      </tr>
      <tr class="value-row">
        <th>{{ inspection_time }}</th>
        <td>{{ aiss_r_a }}</td>
        <td>{{ aiss_s_a }}</td>
        <td>{{ aiss_t_a }}</td>
        <td>{{ aiss_n_a }}</td>
        <td>{{ tr1_temp }}</td>
        <td>{{ tr2_temp }}</td>
      </tr>
    </table>

    <table class="box">
      <colgroup>
        <col style="width: 10%">
        <col style="width: 15%">
        <col style="width: 14%">
        <col style="width: 13%">
        <col style="width: 15%">
        <col style="width: 14%">
        <col style="width: 13%">
      </colgroup>
      <tr>
        <th rowspan="2" class="sub-head">구분</th>
        <th colspan="3" class="blue h-mid">LV - 1</th>
        <th colspan="3" class="blue h-mid">LV - 2</th>
      </tr>
      <tr>
        <th class="sub-head">전압(V)</th>
        <th class="sub-head">전류(A)</th>
        <th class="sub-head">전력(KW)</th>
        <th class="sub-head">전압(V)</th>
        <th class="sub-head">전류(A)</th>
        <th class="sub-head">전력(KW)</th>
      </tr>
      {% for i in range(0, 3) %}
      <tr class="value-row">
        <th class="row-lbl">{{ lv1_rows[i].phase }}</th>
        <td>{{ lv1_rows[i].v }}</td>
        <td>{{ lv1_rows[i].a }}</td>
        <td>{{ lv1_rows[i].kw }}</td>
        <td>{{ lv2_rows[i].v }}</td>
        <td>{{ lv2_rows[i].a }}</td>
        <td>{{ lv2_rows[i].kw }}</td>
      </tr>
      {% endfor %}
    </table>

    <table class="box">
      <colgroup>
        <col style="width: 19%">
        <col style="width: 20%">
        <col style="width: 18%">
        <col style="width: 17%">
        <col style="width: 26%">
      </colgroup>
      <tr>
        <th class="sub-head">구분</th>
        <th class="sub-head">금일지침</th>
        <th class="sub-head">전일지침</th>
        <th class="sub-head">일사용량</th>
        <th class="sub-head">월사용량(Kwh)<br>누계</th>
      </tr>
      {% for row in meter_rows %}
      <tr class="value-row">
        <th class="row-lbl">{{ row.name }}</th>
        <td>{{ row.today }}</td>
        <td>{{ row.prev }}</td>
        <td>{{ row.daily }}</td>
        <td>{{ row.monthly }}</td>
      </tr>
      {% endfor %}
    </table>

    <table class="box">
      <colgroup>
        <col style="width: 10%">
        <col style="width: 15%">
        <col style="width: 10%">
        <col style="width: 22%">
        <col style="width: 21.5%">
        <col style="width: 21.5%">
      </colgroup>
      <tr>
        <th rowspan="2" class="sub-head">저수조<br>수위(%)</th>
        <th class="sub-head">아파트</th>
        <td class="h-small">{{ tank_apartment }}</td>
        <th rowspan="2" class="sub-head">전자식기동용<br>압력스위치</th>
        <th class="sub-head">옥내소화전</th>
        <th class="sub-head">SP보조펌프</th>
      </tr>
      <tr>
        <th class="sub-head">오피스텔</th>
        <td class="h-small">{{ tank_officetel }}</td>
        <td class="h-small">{{ hydrant_pressure }}</td>
        <td class="h-small">{{ sp_pump_pressure }}</td>
      </tr>
      <tr>
        <th rowspan="2" class="sub-head">급수펌프<br>압력</th>
        <th colspan="2" class="sub-head">고층부</th>
        <th class="sub-head">저층부</th>
        <th class="sub-head">오피스텔</th>
        <th class="sub-head">상가</th>
      </tr>
      <tr class="value-row">
        <td colspan="2">{{ high_pressure }}</td>
        <td>{{ low_pressure }}</td>
        <td>{{ office_pressure }}</td>
        <td>{{ shop_pressure }}</td>
      </tr>
    </table>
  </div>
</body>
</html>
