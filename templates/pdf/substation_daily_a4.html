<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <title>{{ title }}</title>
  <style>
    @page {
      size: A4;
      margin: 8mm;
    }
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: "HYSMyeongJo-Medium", "Malgun Gothic", "NanumGothic", sans-serif;
      color: #111;
      font-size: 11px;
      line-height: 1.25;
    }
    .sheet {
      width: 100%;
    }
    .block {
      border: 1.4px solid #111;
      margin-bottom: 6px;
      width: 100%;
    }
    .no-bottom {
      margin-bottom: 0;
    }
    .head-wrap {
      display: flex;
      width: 100%;
      border-bottom: 1px solid #111;
    }
    .head-main {
      flex: 1;
      border-right: 1px solid #111;
      padding: 8px 10px;
    }
    .head-title {
      text-align: center;
      font-size: 39px;
      font-weight: 700;
      letter-spacing: -0.8px;
      margin-bottom: 8px;
      text-decoration: underline;
      text-underline-offset: 3px;
      text-decoration-thickness: 2px;
    }
    .head-meta {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 8px;
      font-size: 12px;
    }
    .head-meta b {
      font-weight: 700;
    }
    .head-approve {
      width: 205px;
      display: grid;
      grid-template-columns: 32px 1fr 1fr;
      min-height: 92px;
    }
    .approve-label {
      border-right: 1px solid #111;
      writing-mode: vertical-rl;
      text-orientation: mixed;
      text-align: center;
      font-weight: 700;
      display: flex;
      justify-content: center;
      align-items: center;
      letter-spacing: 2px;
    }
    .approve-col {
      border-right: 1px solid #111;
      display: grid;
      grid-template-rows: 32px 1fr;
    }
    .approve-col:last-child {
      border-right: 0;
    }
    .approve-role {
      border-bottom: 1px solid #111;
      text-align: center;
      font-weight: 700;
      line-height: 32px;
    }
    .approve-sign {
      min-height: 60px;
    }
    table.form {
      width: 100%;
      border-collapse: collapse;
      table-layout: fixed;
      font-size: 11px;
    }
    table.form th,
    table.form td {
      border: 1px solid #111;
      text-align: center;
      padding: 5px 4px;
      vertical-align: middle;
      word-break: keep-all;
    }
    table.form th {
      font-weight: 700;
      background: #fff;
    }
    .section-title {
      font-weight: 700;
      font-size: 11px;
      padding: 3px 4px;
      background: #e4ebf7;
    }
    .left {
      text-align: left;
    }
    .small {
      font-size: 10px;
    }
    .note-box {
      border-top: 1px solid #111;
      padding: 7px 10px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
      min-height: 48px;
      font-size: 10px;
    }
    .note-cell b {
      margin-right: 4px;
    }
  </style>
</head>
<body>
  <div class="sheet">
    <section class="block no-bottom">
      <div class="head-wrap">
        <div class="head-main">
          <div class="head-title">{{ title }}</div>
          <div class="head-meta">
            <div><b>일자:</b> {{ entry_date_label }}</div>
            <div><b>근무자:</b> {{ worker_name }}</div>
            <div><b>단지:</b> {{ site_name }}</div>
          </div>
        </div>
        <div class="head-approve">
          <div class="approve-label">결재</div>
          <div class="approve-col">
            <div class="approve-role">과장</div>
            <div class="approve-sign"></div>
          </div>
          <div class="approve-col">
            <div class="approve-role">소장</div>
            <div class="approve-sign"></div>
          </div>
        </div>
      </div>

      <table class="form">
        <colgroup>
          <col style="width: 10%">
          <col style="width: 15%">
          <col style="width: 15%">
          <col style="width: 15%">
          <col style="width: 15%">
          <col style="width: 10%">
          <col style="width: 10%">
          <col style="width: 10%">
        </colgroup>
        <tr>
          <th rowspan="2">시간</th>
          <th colspan="5">AISS {{ aiss_kv }} [KV]</th>
          <th colspan="2">변압기 온도(℃)</th>
        </tr>
        <tr>
          <th>R(A)</th>
          <th>S(A)</th>
          <th>T(A)</th>
          <th>N(A)</th>
          <th class="small">근무형태</th>
          <th class="small">TR-1(450KVA)</th>
          <th class="small">TR-2(400KVA)</th>
        </tr>
        <tr>
          <td><b>{{ inspection_time }}</b></td>
          <td>{{ aiss_r_a }}</td>
          <td>{{ aiss_s_a }}</td>
          <td>{{ aiss_t_a }}</td>
          <td>{{ aiss_n_a }}</td>
          <td>{{ work_type }}</td>
          <td>{{ tr1_temp }}</td>
          <td>{{ tr2_temp }}</td>
        </tr>
      </table>
    </section>

    <section class="block">
      <table class="form">
        <colgroup>
          <col style="width: 10%">
          <col style="width: 15%">
          <col style="width: 14%">
          <col style="width: 13%">
          <col style="width: 15%">
          <col style="width: 14%">
          <col style="width: 13%">
        </colgroup>
        <tr>
          <th rowspan="2">구분</th>
          <th colspan="3" class="section-title">LV - 1</th>
          <th colspan="3" class="section-title">LV - 2</th>
        </tr>
        <tr>
          <th>전압(V)</th>
          <th>전류(A)</th>
          <th>전력(KW)</th>
          <th>전압(V)</th>
          <th>전류(A)</th>
          <th>전력(KW)</th>
        </tr>
        {% for i in range(0, 3) %}
        <tr>
          <th>{{ lv1_rows[i].phase }}</th>
          <td>{{ lv1_rows[i].v }}</td>
          <td>{{ lv1_rows[i].a }}</td>
          <td>{{ lv1_rows[i].kw }}</td>
          <td>{{ lv2_rows[i].v }}</td>
          <td>{{ lv2_rows[i].a }}</td>
          <td>{{ lv2_rows[i].kw }}</td>
        </tr>
        {% endfor %}
      </table>
    </section>

    <section class="block">
      <table class="form">
        <colgroup>
          <col style="width: 19%">
          <col style="width: 21%">
          <col style="width: 18%">
          <col style="width: 18%">
          <col style="width: 24%">
        </colgroup>
        <tr>
          <th>구분</th>
          <th>금일지침</th>
          <th>전일지침</th>
          <th>일사용량</th>
          <th>월사용량(kWh) 누계</th>
        </tr>
        {% for row in meter_rows %}
        <tr>
          <th>{{ row.name }}</th>
          <td>{{ row.today }}</td>
          <td>{{ row.prev }}</td>
          <td>{{ row.daily }}</td>
          <td>{{ row.monthly }}</td>
        </tr>
        {% endfor %}
      </table>
    </section>

    <section class="block">
      <table class="form">
        <colgroup>
          <col style="width: 10%">
          <col style="width: 15%">
          <col style="width: 10%">
          <col style="width: 23%">
          <col style="width: 21%">
          <col style="width: 21%">
        </colgroup>
        <tr>
          <th rowspan="2">저수조 수위(%)</th>
          <th>아파트</th>
          <td>{{ tank_apartment }}</td>
          <th rowspan="2">전자식기동용 압력스위치</th>
          <th>옥내소화전</th>
          <th>SP보조펌프</th>
        </tr>
        <tr>
          <th>오피스텔</th>
          <td>{{ tank_officetel }}</td>
          <td>{{ hydrant_pressure }}</td>
          <td>{{ sp_pump_pressure }}</td>
        </tr>
        <tr>
          <th rowspan="2">급수펌프 압력</th>
          <th colspan="2">고층부</th>
          <th colspan="1">저층부</th>
          <th>오피스텔</th>
          <th>상가</th>
        </tr>
        <tr>
          <td colspan="2">{{ high_pressure }}</td>
          <td>{{ low_pressure }}</td>
          <td>{{ office_pressure }}</td>
          <td>{{ shop_pressure }}</td>
        </tr>
      </table>
      <div class="note-box">
        <div class="note-cell left"><b>중요작업:</b> {{ important_work }}</div>
        <div class="note-cell left"><b>비고:</b> {{ note }}</div>
      </div>
    </section>
  </div>
</body>
</html>
